(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var ke=function(t,e){return ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},ke(t,e)};function J(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");ke(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function _e(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Se(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),i,s=[],l;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(y){l={error:y}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(l)throw l.error}}return s}function Ee(t,e,r){if(r||arguments.length===2)for(var n=0,i=e.length,s;n<i;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}function L(t){return typeof t=="function"}function ot(t){var e=function(n){Error.call(n),n.stack=new Error().stack},r=t(e);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var me=ot(function(t){return function(r){t(this),this.message=r?r.length+` errors occurred during unsubscription:
`+r.map(function(n,i){return i+1+") "+n.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=r}});function Te(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var re=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,r,n,i,s;if(!this.closed){this.closed=!0;var l=this._parentage;if(l)if(this._parentage=null,Array.isArray(l))try{for(var y=_e(l),g=y.next();!g.done;g=y.next()){var _=g.value;_.remove(this)}}catch(E){e={error:E}}finally{try{g&&!g.done&&(r=y.return)&&r.call(y)}finally{if(e)throw e.error}}else l.remove(this);var I=this.initialTeardown;if(L(I))try{I()}catch(E){s=E instanceof me?E.errors:[E]}var V=this._finalizers;if(V){this._finalizers=null;try{for(var D=_e(V),O=D.next();!O.done;O=D.next()){var P=O.value;try{Ye(P)}catch(E){s=s??[],E instanceof me?s=Ee(Ee([],Se(s)),Se(E.errors)):s.push(E)}}}catch(E){n={error:E}}finally{try{O&&!O.done&&(i=D.return)&&i.call(D)}finally{if(n)throw n.error}}}if(s)throw new me(s)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)Ye(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(e)}},t.prototype._hasParent=function(e){var r=this._parentage;return r===e||Array.isArray(r)&&r.includes(e)},t.prototype._addParent=function(e){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e},t.prototype._removeParent=function(e){var r=this._parentage;r===e?this._parentage=null:Array.isArray(r)&&Te(r,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&Te(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),it=re.EMPTY;function st(t){return t instanceof re||t&&"closed"in t&&L(t.remove)&&L(t.add)&&L(t.unsubscribe)}function Ye(t){L(t)?t():t.unsubscribe()}var Tt={Promise:void 0},Ut={setTimeout:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,Ee([t,e],Se(r)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function At(t){Ut.setTimeout(function(){throw t})}function $e(){}function Q(t){t()}var Oe=function(t){J(e,t);function e(r){var n=t.call(this)||this;return n.isStopped=!1,r?(n.destination=r,st(r)&&r.add(n)):n.destination=It,n}return e.create=function(r,n,i){return new Ue(r,n,i)},e.prototype.next=function(r){this.isStopped||this._next(r)},e.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(r){this.destination.next(r)},e.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(re),Pt=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var r=this.partialObserver;if(r.next)try{r.next(e)}catch(n){G(n)}},t.prototype.error=function(e){var r=this.partialObserver;if(r.error)try{r.error(e)}catch(n){G(n)}else G(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(r){G(r)}},t}(),Ue=function(t){J(e,t);function e(r,n,i){var s=t.call(this)||this,l;return L(r)||!r?l={next:r??void 0,error:n??void 0,complete:i??void 0}:l=r,s.destination=new Pt(l),s}return e}(Oe);function G(t){At(t)}function Ct(t){throw t}var It={closed:!0,next:$e,error:Ct,complete:$e},xt=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function at(t){return t}function Lt(t){return t.length===0?at:t.length===1?t[0]:function(r){return t.reduce(function(n,i){return i(n)},r)}}var qe=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(e,r,n){var i=this,s=Ot(e)?e:new Ue(e,r,n);return Q(function(){var l=i,y=l.operator,g=l.source;s.add(y?y.call(s,g):g?i._subscribe(s):i._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(r){e.error(r)}},t.prototype.forEach=function(e,r){var n=this;return r=Ve(r),new r(function(i,s){var l=new Ue({next:function(y){try{e(y)}catch(g){s(g),l.unsubscribe()}},error:s,complete:i});n.subscribe(l)})},t.prototype._subscribe=function(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)},t.prototype[xt]=function(){return this},t.prototype.pipe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Lt(e)(this)},t.prototype.toPromise=function(e){var r=this;return e=Ve(e),new e(function(n,i){var s;r.subscribe(function(l){return s=l},function(l){return i(l)},function(){return n(s)})})},t.create=function(e){return new t(e)},t}();function Ve(t){var e;return(e=t??Tt.Promise)!==null&&e!==void 0?e:Promise}function Rt(t){return t&&L(t.next)&&L(t.error)&&L(t.complete)}function Ot(t){return t&&t instanceof Oe||Rt(t)&&st(t)}function Mt(t){return L(t==null?void 0:t.lift)}function Me(t){return function(e){if(Mt(e))return e.lift(function(r){try{return t(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function ze(t,e,r,n,i){return new zt(t,e,r,n,i)}var zt=function(t){J(e,t);function e(r,n,i,s,l,y){var g=t.call(this,r)||this;return g.onFinalize=l,g.shouldUnsubscribe=y,g._next=n?function(_){try{n(_)}catch(I){r.error(I)}}:t.prototype._next,g._error=s?function(_){try{s(_)}catch(I){r.error(I)}finally{this.unsubscribe()}}:t.prototype._error,g._complete=i?function(){try{i()}catch(_){r.error(_)}finally{this.unsubscribe()}}:t.prototype._complete,g}return e.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},e}(Oe),jt=ot(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),ct=function(t){J(e,t);function e(){var r=t.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return e.prototype.lift=function(r){var n=new We(this,this);return n.operator=r,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new jt},e.prototype.next=function(r){var n=this;Q(function(){var i,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var l=_e(n.currentObservers),y=l.next();!y.done;y=l.next()){var g=y.value;g.next(r)}}catch(_){i={error:_}}finally{try{y&&!y.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}}})},e.prototype.error=function(r){var n=this;Q(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var i=n.observers;i.length;)i.shift().error(r)}})},e.prototype.complete=function(){var r=this;Q(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(r){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,r)},e.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},e.prototype._innerSubscribe=function(r){var n=this,i=this,s=i.hasError,l=i.isStopped,y=i.observers;return s||l?it:(this.currentObservers=null,y.push(r),new re(function(){n.currentObservers=null,Te(y,r)}))},e.prototype._checkFinalizedStatuses=function(r){var n=this,i=n.hasError,s=n.thrownError,l=n.isStopped;i?r.error(s):l&&r.complete()},e.prototype.asObservable=function(){var r=new qe;return r.source=this,r},e.create=function(r,n){return new We(r,n)},e}(qe),We=function(t){J(e,t);function e(r,n){var i=t.call(this)||this;return i.destination=r,i.source=n,i}return e.prototype.next=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.next)===null||i===void 0||i.call(n,r)},e.prototype.error=function(r){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.error)===null||i===void 0||i.call(n,r)},e.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},e.prototype._subscribe=function(r){var n,i;return(i=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&i!==void 0?i:it},e}(ct),Ft=function(t){J(e,t);function e(r){var n=t.call(this)||this;return n._value=r,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(r){var n=t.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},e.prototype.getValue=function(){var r=this,n=r.hasError,i=r.thrownError,s=r._value;if(n)throw i;return this._throwIfClosed(),s},e.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},e}(ct);function je(t,e){return Me(function(r,n){var i=0;r.subscribe(ze(n,function(s){n.next(t.call(e,s,i++))}))})}function Xe(t,e){return Me(function(r,n){var i=0;r.subscribe(ze(n,function(s){return t.call(e,s,i++)&&n.next(s)}))})}function ne(t,e){return e===void 0&&(e=at),t=t??Nt,Me(function(r,n){var i,s=!0;r.subscribe(ze(n,function(l){var y=e(l);(s||!t(i,y))&&(s=!1,i=y,n.next(l))}))})}function Nt(t,e){return t===e}function ut(t){if(!(this instanceof ut))throw new Error("The 'Keycloak' constructor must be invoked with 'new'.");if(typeof t!="string"&&!be(t))throw new Error("The 'Keycloak' constructor must be provided with a configuration object, or a URL to a JSON configuration file.");if(be(t)){const o="oidcProvider"in t?["clientId"]:["url","realm","clientId"];for(const a of o)if(!t[a])throw new Error(`The configuration object is missing the required '${a}' property.`)}var e=this,r,n=[],i,s={enable:!0,callbackList:[],interval:5};e.didInitialize=!1;var l=!0,y=Je(console.info),g=Je(console.warn);globalThis.isSecureContext||g(`[KEYCLOAK] Keycloak JS must be used in a 'secure context' to function properly as it relies on browser APIs that are otherwise not available.
Continuing to run your application insecurely will lead to unexpected behavior and breakage.

For more information see: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts`),e.init=function(o={}){if(e.didInitialize)throw new Error("A 'Keycloak' instance can only be initialized once.");e.didInitialize=!0,e.authenticated=!1,i=Et();var a=["default","cordova","cordova-native"];if(a.indexOf(o.adapter)>-1?r=de(o.adapter):typeof o.adapter=="object"?r=o.adapter:window.Cordova||window.cordova?r=de("cordova"):r=de(),typeof o.useNonce<"u"&&(l=o.useNonce),typeof o.checkLoginIframe<"u"&&(s.enable=o.checkLoginIframe),o.checkLoginIframeInterval&&(s.interval=o.checkLoginIframeInterval),o.onLoad==="login-required"&&(e.loginRequired=!0),o.responseMode)if(o.responseMode==="query"||o.responseMode==="fragment")e.responseMode=o.responseMode;else throw"Invalid value for responseMode";if(o.flow){switch(o.flow){case"standard":e.responseType="code";break;case"implicit":e.responseType="id_token token";break;case"hybrid":e.responseType="code id_token token";break;default:throw"Invalid value for flow"}e.flow=o.flow}if(o.timeSkew!=null&&(e.timeSkew=o.timeSkew),o.redirectUri&&(e.redirectUri=o.redirectUri),o.silentCheckSsoRedirectUri&&(e.silentCheckSsoRedirectUri=o.silentCheckSsoRedirectUri),typeof o.silentCheckSsoFallback=="boolean"?e.silentCheckSsoFallback=o.silentCheckSsoFallback:e.silentCheckSsoFallback=!0,typeof o.pkceMethod<"u"){if(o.pkceMethod!=="S256"&&o.pkceMethod!==!1)throw new TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${o.pkceMethod}.`);e.pkceMethod=o.pkceMethod}else e.pkceMethod="S256";typeof o.enableLogging=="boolean"?e.enableLogging=o.enableLogging:e.enableLogging=!1,o.logoutMethod==="POST"?e.logoutMethod="POST":e.logoutMethod="GET",typeof o.scope=="string"&&(e.scope=o.scope),typeof o.acrValues=="string"&&(e.acrValues=o.acrValues),typeof o.messageReceiveTimeout=="number"&&o.messageReceiveTimeout>0?e.messageReceiveTimeout=o.messageReceiveTimeout:e.messageReceiveTimeout=1e4,e.responseMode||(e.responseMode="fragment"),e.responseType||(e.responseType="code",e.flow="standard");var p=k(),d=k();d.promise.then(function(){e.onReady&&e.onReady(e.authenticated),p.setSuccess(e.authenticated)}).catch(function(u){p.setError(u)});var f=wt();function h(){var u=function(v){v||(b.prompt="none"),o.locale&&(b.locale=o.locale),e.login(b).then(function(){d.setSuccess()}).catch(function(w){d.setError(w)})},m=async function(){var v=document.createElement("iframe"),w=await e.createLoginUrl({prompt:"none",redirectUri:e.silentCheckSsoRedirectUri});v.setAttribute("src",w),v.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),v.setAttribute("title","keycloak-silent-check-sso"),v.style.display="none",document.body.appendChild(v);var S=function(R){if(!(R.origin!==window.location.origin||v.contentWindow!==R.source)){var x=z(R.data);M(x,d),document.body.removeChild(v),window.removeEventListener("message",S)}};window.addEventListener("message",S)},b={};switch(o.onLoad){case"check-sso":s.enable?le().then(function(){X().then(function(v){v?d.setSuccess():e.silentCheckSsoRedirectUri?m():u(!1)}).catch(function(v){d.setError(v)})}):e.silentCheckSsoRedirectUri?m():u(!1);break;case"login-required":u(!0);break;default:throw"Invalid value for onLoad"}}function c(){var u=z(window.location.href);if(u&&window.history.replaceState(window.history.state,null,u.newUrl),u&&u.valid)return le().then(function(){M(u,d)}).catch(function(m){d.setError(m)});o.token&&o.refreshToken?(W(o.token,o.refreshToken,o.idToken),s.enable?le().then(function(){X().then(function(m){m?(e.onAuthSuccess&&e.onAuthSuccess(),d.setSuccess(),fe()):d.setSuccess()}).catch(function(m){d.setError(m)})}):e.updateToken(-1).then(function(){e.onAuthSuccess&&e.onAuthSuccess(),d.setSuccess()}).catch(function(m){e.onAuthError&&e.onAuthError(),o.onLoad?h():d.setError(m)})):o.onLoad?h():d.setSuccess()}return f.then(function(){St().then(c).catch(function(u){p.setError(u)})}),f.catch(function(u){p.setError(u)}),p.promise},e.login=function(o){return r.login(o)};function _(o){if(typeof crypto>"u"||typeof crypto.getRandomValues>"u")throw new Error("Web Crypto API is not available.");return crypto.getRandomValues(new Uint8Array(o))}function I(o){return V(o,"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789")}function V(o,a){for(var p=_(o),d=new Array(o),f=0;f<o;f++)d[f]=a.charCodeAt(p[f]%a.length);return String.fromCharCode.apply(null,d)}async function D(o,a){if(o!=="S256")throw new TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${o}'.`);const p=new Uint8Array(await Ht(a));return Dt(p).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}function O(o){var a={id_token:{acr:o}};return JSON.stringify(a)}e.createLoginUrl=async function(o){var a=Ke(),p=Ke(),d=r.redirectUri(o),f={state:a,nonce:p,redirectUri:encodeURIComponent(d),loginOptions:o};o&&o.prompt&&(f.prompt=o.prompt);var h;o&&o.action=="register"?h=e.endpoints.register():h=e.endpoints.authorize();var c=o&&o.scope||e.scope;c?c.indexOf("openid")===-1&&(c="openid "+c):c="openid";var u=h+"?client_id="+encodeURIComponent(e.clientId)+"&redirect_uri="+encodeURIComponent(d)+"&state="+encodeURIComponent(a)+"&response_mode="+encodeURIComponent(e.responseMode)+"&response_type="+encodeURIComponent(e.responseType)+"&scope="+encodeURIComponent(c);if(l&&(u=u+"&nonce="+encodeURIComponent(p)),o&&o.prompt&&(u+="&prompt="+encodeURIComponent(o.prompt)),o&&typeof o.maxAge=="number"&&(u+="&max_age="+encodeURIComponent(o.maxAge)),o&&o.loginHint&&(u+="&login_hint="+encodeURIComponent(o.loginHint)),o&&o.idpHint&&(u+="&kc_idp_hint="+encodeURIComponent(o.idpHint)),o&&o.action&&o.action!="register"&&(u+="&kc_action="+encodeURIComponent(o.action)),o&&o.locale&&(u+="&ui_locales="+encodeURIComponent(o.locale)),o&&o.acr){var m=O(o.acr);u+="&claims="+encodeURIComponent(m)}if((o&&o.acrValues||e.acrValues)&&(u+="&acr_values="+encodeURIComponent(o.acrValues||e.acrValues)),e.pkceMethod)try{const b=I(96),v=await D(e.pkceMethod,b);f.pkceCodeVerifier=b,u+="&code_challenge="+v,u+="&code_challenge_method="+e.pkceMethod}catch(b){throw new Error("Failed to generate PKCE challenge.",{cause:b})}return i.add(f),u},e.logout=function(o){return r.logout(o)},e.createLogoutUrl=function(o){if(((o==null?void 0:o.logoutMethod)??e.logoutMethod)==="POST")return e.endpoints.logout();var p=e.endpoints.logout()+"?client_id="+encodeURIComponent(e.clientId)+"&post_logout_redirect_uri="+encodeURIComponent(r.redirectUri(o,!1));return e.idToken&&(p+="&id_token_hint="+encodeURIComponent(e.idToken)),p},e.register=function(o){return r.register(o)},e.createRegisterUrl=async function(o){return o||(o={}),o.action="register",await e.createLoginUrl(o)},e.createAccountUrl=function(o){var a=P(),p=void 0;return typeof a<"u"&&(p=a+"/account?referrer="+encodeURIComponent(e.clientId)+"&referrer_uri="+encodeURIComponent(r.redirectUri(o))),p},e.accountManagement=function(){return r.accountManagement()},e.hasRealmRole=function(o){var a=e.realmAccess;return!!a&&a.roles.indexOf(o)>=0},e.hasResourceRole=function(o,a){if(!e.resourceAccess)return!1;var p=e.resourceAccess[a||e.clientId];return!!p&&p.roles.indexOf(o)>=0},e.loadUserProfile=function(){var o=P()+"/account",a=new XMLHttpRequest;a.open("GET",o,!0),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Authorization","bearer "+e.token);var p=k();return a.onreadystatechange=function(){a.readyState==4&&(a.status==200?(e.profile=JSON.parse(a.responseText),p.setSuccess(e.profile)):p.setError())},a.send(),p.promise},e.loadUserInfo=function(){var o=e.endpoints.userinfo(),a=new XMLHttpRequest;a.open("GET",o,!0),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Authorization","bearer "+e.token);var p=k();return a.onreadystatechange=function(){a.readyState==4&&(a.status==200?(e.userInfo=JSON.parse(a.responseText),p.setSuccess(e.userInfo)):p.setError())},a.send(),p.promise},e.isTokenExpired=function(o){if(!e.tokenParsed||!e.refreshToken&&e.flow!="implicit")throw"Not authenticated";if(e.timeSkew==null)return y("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;var a=e.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+e.timeSkew;if(o){if(isNaN(o))throw"Invalid minValidity";a-=o}return a<0},e.updateToken=function(o){var a=k();if(!e.refreshToken)return a.setError(),a.promise;o=o||5;var p=function(){var f=!1;if(o==-1?(f=!0,y("[KEYCLOAK] Refreshing token: forced refresh")):(!e.tokenParsed||e.isTokenExpired(o))&&(f=!0,y("[KEYCLOAK] Refreshing token: token expired")),!f)a.setSuccess(!1);else{var h="grant_type=refresh_token&refresh_token="+e.refreshToken,c=e.endpoints.token();if(n.push(a),n.length==1){var u=new XMLHttpRequest;u.open("POST",c,!0),u.setRequestHeader("Content-type","application/x-www-form-urlencoded"),u.withCredentials=!0,h+="&client_id="+encodeURIComponent(e.clientId);var m=new Date().getTime();u.onreadystatechange=function(){if(u.readyState==4)if(u.status==200){y("[KEYCLOAK] Token refreshed"),m=(m+new Date().getTime())/2;var b=JSON.parse(u.responseText);W(b.access_token,b.refresh_token,b.id_token,m),e.onAuthRefreshSuccess&&e.onAuthRefreshSuccess();for(var v=n.pop();v!=null;v=n.pop())v.setSuccess(!0)}else{g("[KEYCLOAK] Failed to refresh token"),u.status==400&&e.clearToken(),e.onAuthRefreshError&&e.onAuthRefreshError();for(var v=n.pop();v!=null;v=n.pop())v.setError("Failed to refresh token: An unexpected HTTP error occurred while attempting to refresh the token.")}},u.send(h)}}};if(s.enable){var d=X();d.then(function(){p()}).catch(function(f){a.setError(f)})}else p();return a.promise},e.clearToken=function(){e.token&&(W(null,null,null),e.onAuthLogout&&e.onAuthLogout(),e.loginRequired&&e.login())};function P(){if(typeof e.authServerUrl<"u")return e.authServerUrl.charAt(e.authServerUrl.length-1)=="/"?e.authServerUrl+"realms/"+encodeURIComponent(e.realm):e.authServerUrl+"/realms/"+encodeURIComponent(e.realm)}function E(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function M(o,a){var p=o.code,d=o.error,f=o.prompt,h=new Date().getTime();if(o.kc_action_status&&e.onActionUpdate&&e.onActionUpdate(o.kc_action_status,o.kc_action),d){if(f!="none")if(o.error_description&&o.error_description==="authentication_expired")e.login(o.loginOptions);else{var c={error:d,error_description:o.error_description};e.onAuthError&&e.onAuthError(c),a&&a.setError(c)}else a&&a.setSuccess();return}else e.flow!="standard"&&(o.access_token||o.id_token)&&v(o.access_token,null,o.id_token,!0);if(e.flow!="implicit"&&p){var u="code="+p+"&grant_type=authorization_code",m=e.endpoints.token(),b=new XMLHttpRequest;b.open("POST",m,!0),b.setRequestHeader("Content-type","application/x-www-form-urlencoded"),u+="&client_id="+encodeURIComponent(e.clientId),u+="&redirect_uri="+o.redirectUri,o.pkceCodeVerifier&&(u+="&code_verifier="+o.pkceCodeVerifier),b.withCredentials=!0,b.onreadystatechange=function(){if(b.readyState==4)if(b.status==200){var w=JSON.parse(b.responseText);v(w.access_token,w.refresh_token,w.id_token,e.flow==="standard"),fe()}else e.onAuthError&&e.onAuthError(),a&&a.setError()},b.send(u)}function v(w,S,R,x){h=(h+new Date().getTime())/2,W(w,S,R,h),l&&e.idTokenParsed&&e.idTokenParsed.nonce!=o.storedNonce?(y("[KEYCLOAK] Invalid nonce, clearing token"),e.clearToken(),a&&a.setError()):x&&(e.onAuthSuccess&&e.onAuthSuccess(),a&&a.setSuccess())}}function wt(){var o=k(),a;typeof t=="string"&&(a=t);function p(c){c?e.endpoints={authorize:function(){return c.authorization_endpoint},token:function(){return c.token_endpoint},logout:function(){if(!c.end_session_endpoint)throw"Not supported by the OIDC server";return c.end_session_endpoint},checkSessionIframe:function(){if(!c.check_session_iframe)throw"Not supported by the OIDC server";return c.check_session_iframe},register:function(){throw'Redirection to "Register user" page not supported in standard OIDC mode'},userinfo:function(){if(!c.userinfo_endpoint)throw"Not supported by the OIDC server";return c.userinfo_endpoint}}:e.endpoints={authorize:function(){return P()+"/protocol/openid-connect/auth"},token:function(){return P()+"/protocol/openid-connect/token"},logout:function(){return P()+"/protocol/openid-connect/logout"},checkSessionIframe:function(){return P()+"/protocol/openid-connect/login-status-iframe.html"},thirdPartyCookiesIframe:function(){return P()+"/protocol/openid-connect/3p-cookies/step1.html"},register:function(){return P()+"/protocol/openid-connect/registrations"},userinfo:function(){return P()+"/protocol/openid-connect/userinfo"}}}if(a){var d=new XMLHttpRequest;d.open("GET",a,!0),d.setRequestHeader("Accept","application/json"),d.onreadystatechange=function(){if(d.readyState==4)if(d.status==200||He(d)){var c=JSON.parse(d.responseText);e.authServerUrl=c["auth-server-url"],e.realm=c.realm,e.clientId=c.resource,p(null),o.setSuccess()}else o.setError()},d.send()}else{e.clientId=t.clientId;var f=t.oidcProvider;if(!f)e.authServerUrl=t.url,e.realm=t.realm,p(null),o.setSuccess();else if(typeof f=="string"){var h;f.charAt(f.length-1)=="/"?h=f+".well-known/openid-configuration":h=f+"/.well-known/openid-configuration";var d=new XMLHttpRequest;d.open("GET",h,!0),d.setRequestHeader("Accept","application/json"),d.onreadystatechange=function(){if(d.readyState==4)if(d.status==200||He(d)){var u=JSON.parse(d.responseText);p(u),o.setSuccess()}else o.setError()},d.send()}else p(f),o.setSuccess()}return o.promise}function He(o){return o.status==0&&o.responseText&&o.responseURL.startsWith("file:")}function W(o,a,p,d){if(e.tokenTimeoutHandle&&(clearTimeout(e.tokenTimeoutHandle),e.tokenTimeoutHandle=null),a?(e.refreshToken=a,e.refreshTokenParsed=ve(a)):(delete e.refreshToken,delete e.refreshTokenParsed),p?(e.idToken=p,e.idTokenParsed=ve(p)):(delete e.idToken,delete e.idTokenParsed),o){if(e.token=o,e.tokenParsed=ve(o),e.sessionId=e.tokenParsed.sid,e.authenticated=!0,e.subject=e.tokenParsed.sub,e.realmAccess=e.tokenParsed.realm_access,e.resourceAccess=e.tokenParsed.resource_access,d&&(e.timeSkew=Math.floor(d/1e3)-e.tokenParsed.iat),e.timeSkew!=null&&(y("[KEYCLOAK] Estimated time difference between browser and server is "+e.timeSkew+" seconds"),e.onTokenExpired)){var f=(e.tokenParsed.exp-new Date().getTime()/1e3+e.timeSkew)*1e3;y("[KEYCLOAK] Token expires in "+Math.round(f/1e3)+" s"),f<=0?e.onTokenExpired():e.tokenTimeoutHandle=setTimeout(e.onTokenExpired,f)}}else delete e.token,delete e.tokenParsed,delete e.subject,delete e.realmAccess,delete e.resourceAccess,e.authenticated=!1}function Ke(){if(typeof crypto>"u"||typeof crypto.randomUUID>"u")throw new Error("Web Crypto API is not available.");return crypto.randomUUID()}function z(o){var a=kt(o);if(a){var p=i.get(a.state);return p&&(a.valid=!0,a.redirectUri=p.redirectUri,a.storedNonce=p.nonce,a.prompt=p.prompt,a.pkceCodeVerifier=p.pkceCodeVerifier,a.loginOptions=p.loginOptions),a}}function kt(o){var a;switch(e.flow){case"standard":a=["code","state","session_state","kc_action_status","kc_action","iss"];break;case"implicit":a=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status","kc_action","iss"];break;case"hybrid":a=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status","kc_action","iss"];break}a.push("error"),a.push("error_description"),a.push("error_uri");var p=o.indexOf("?"),d=o.indexOf("#"),f,h;if(e.responseMode==="query"&&p!==-1?(f=o.substring(0,p),h=Be(o.substring(p+1,d!==-1?d:o.length),a),h.paramsString!==""&&(f+="?"+h.paramsString),d!==-1&&(f+=o.substring(d))):e.responseMode==="fragment"&&d!==-1&&(f=o.substring(0,d),h=Be(o.substring(d+1),a),h.paramsString!==""&&(f+="#"+h.paramsString)),h&&h.oauthParams){if(e.flow==="standard"||e.flow==="hybrid"){if((h.oauthParams.code||h.oauthParams.error)&&h.oauthParams.state)return h.oauthParams.newUrl=f,h.oauthParams}else if(e.flow==="implicit"&&(h.oauthParams.access_token||h.oauthParams.error)&&h.oauthParams.state)return h.oauthParams.newUrl=f,h.oauthParams}}function Be(o,a){for(var p=o.split("&"),d={paramsString:"",oauthParams:{}},f=0;f<p.length;f++){var h=p[f].indexOf("="),c=p[f].slice(0,h);a.indexOf(c)!==-1?d.oauthParams[c]=p[f].slice(h+1):(d.paramsString!==""&&(d.paramsString+="&"),d.paramsString+=p[f])}return d}function k(){var o={setSuccess:function(a){o.resolve(a)},setError:function(a){o.reject(a)}};return o.promise=new Promise(function(a,p){o.resolve=a,o.reject=p}),o}function _t(o,a,p){var d=null,f=new Promise(function(h,c){d=setTimeout(function(){c({error:p})},a)});return Promise.race([o,f]).finally(function(){clearTimeout(d)})}function le(){var o=k();if(!s.enable||s.iframe)return o.setSuccess(),o.promise;var a=document.createElement("iframe");s.iframe=a,a.onload=function(){var f=e.endpoints.authorize();f.charAt(0)==="/"?s.iframeOrigin=E():s.iframeOrigin=f.substring(0,f.indexOf("/",8)),o.setSuccess()};var p=e.endpoints.checkSessionIframe();a.setAttribute("src",p),a.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),a.setAttribute("title","keycloak-session-iframe"),a.style.display="none",document.body.appendChild(a);var d=function(f){if(!(f.origin!==s.iframeOrigin||s.iframe.contentWindow!==f.source)&&(f.data=="unchanged"||f.data=="changed"||f.data=="error")){f.data!="unchanged"&&e.clearToken();for(var h=s.callbackList.splice(0,s.callbackList.length),c=h.length-1;c>=0;--c){var u=h[c];f.data=="error"?u.setError():u.setSuccess(f.data=="unchanged")}}};return window.addEventListener("message",d,!1),o.promise}function fe(){s.enable&&e.token&&setTimeout(function(){X().then(function(o){o&&fe()})},s.interval*1e3)}function X(){var o=k();if(s.iframe&&s.iframeOrigin){var a=e.clientId+" "+(e.sessionId?e.sessionId:"");s.callbackList.push(o);var p=s.iframeOrigin;s.callbackList.length==1&&s.iframe.contentWindow.postMessage(a,p)}else o.setSuccess();return o.promise}function St(){var o=k();if((s.enable||e.silentCheckSsoRedirectUri)&&typeof e.endpoints.thirdPartyCookiesIframe=="function"){var a=document.createElement("iframe");a.setAttribute("src",e.endpoints.thirdPartyCookiesIframe()),a.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),a.setAttribute("title","keycloak-3p-check-iframe"),a.style.display="none",document.body.appendChild(a);var p=function(d){a.contentWindow===d.source&&(d.data!=="supported"&&d.data!=="unsupported"||(d.data==="unsupported"&&(g(`[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:

 - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).
 - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).

For more information see: https://www.keycloak.org/securing-apps/javascript-adapter#_modern_browsers`),s.enable=!1,e.silentCheckSsoFallback&&(e.silentCheckSsoRedirectUri=!1)),document.body.removeChild(a),window.removeEventListener("message",p),o.setSuccess()))};window.addEventListener("message",p,!1)}else o.setSuccess();return _t(o.promise,e.messageReceiveTimeout,"Timeout when waiting for 3rd party check iframe message.")}function de(o){if(!o||o=="default")return{login:async function(c){return window.location.assign(await e.createLoginUrl(c)),k().promise},logout:async function(c){if(((c==null?void 0:c.logoutMethod)??e.logoutMethod)==="GET"){window.location.replace(e.createLogoutUrl(c));return}const m=document.createElement("form");m.setAttribute("method","POST"),m.setAttribute("action",e.createLogoutUrl(c)),m.style.display="none";const b={id_token_hint:e.idToken,client_id:e.clientId,post_logout_redirect_uri:r.redirectUri(c,!1)};for(const[v,w]of Object.entries(b)){const S=document.createElement("input");S.setAttribute("type","hidden"),S.setAttribute("name",v),S.setAttribute("value",w),m.appendChild(S)}document.body.appendChild(m),m.submit()},register:async function(c){return window.location.assign(await e.createRegisterUrl(c)),k().promise},accountManagement:function(){var c=e.createAccountUrl();if(typeof c<"u")window.location.href=c;else throw"Not supported by the OIDC server";return k().promise},redirectUri:function(c,u){return c&&c.redirectUri?c.redirectUri:e.redirectUri?e.redirectUri:location.href}};if(o=="cordova"){s.enable=!1;var a=function(c,u,m){return window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(c,u,m):window.open(c,u,m)},p=function(c){return c&&c.cordovaOptions?Object.keys(c.cordovaOptions).reduce(function(u,m){return u[m]=c.cordovaOptions[m],u},{}):{}},d=function(c){return Object.keys(c).reduce(function(u,m){return u.push(m+"="+c[m]),u},[]).join(",")},f=function(c){var u=p(c);return u.location="no",c&&c.prompt=="none"&&(u.hidden="yes"),d(u)},h=function(){return e.redirectUri||"http://localhost"};return{login:async function(c){var u=k(),m=f(c),b=await e.createLoginUrl(c),v=a(b,"_blank",m),w=!1,S=!1,R=function(){S=!0,v.close()};return v.addEventListener("loadstart",function(x){if(x.url.indexOf(h())==0){var ye=z(x.url);M(ye,u),R(),w=!0}}),v.addEventListener("loaderror",function(x){if(!w)if(x.url.indexOf(h())==0){var ye=z(x.url);M(ye,u),R(),w=!0}else u.setError(),R()}),v.addEventListener("exit",function(x){S||u.setError({reason:"closed_by_user"})}),u.promise},logout:function(c){var u=k(),m=e.createLogoutUrl(c),b=a(m,"_blank","location=no,hidden=yes,clearcache=yes"),v;return b.addEventListener("loadstart",function(w){w.url.indexOf(h())==0&&b.close()}),b.addEventListener("loaderror",function(w){w.url.indexOf(h())==0||(v=!0),b.close()}),b.addEventListener("exit",function(w){v?u.setError():(e.clearToken(),u.setSuccess())}),u.promise},register:async function(c){var u=k(),m=await e.createRegisterUrl(),b=f(c),v=a(m,"_blank",b);return v.addEventListener("loadstart",function(w){if(w.url.indexOf(h())==0){v.close();var S=z(w.url);M(S,u)}}),u.promise},accountManagement:function(){var c=e.createAccountUrl();if(typeof c<"u"){var u=a(c,"_blank","location=no");u.addEventListener("loadstart",function(m){m.url.indexOf(h())==0&&u.close()})}else throw"Not supported by the OIDC server"},redirectUri:function(c){return h()}}}if(o=="cordova-native")return s.enable=!1,{login:async function(c){var u=k(),m=await e.createLoginUrl(c);return universalLinks.subscribe("keycloak",function(b){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var v=z(b.url);M(v,u)}),window.cordova.plugins.browsertab.openUrl(m),u.promise},logout:function(c){var u=k(),m=e.createLogoutUrl(c);return universalLinks.subscribe("keycloak",function(b){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),e.clearToken(),u.setSuccess()}),window.cordova.plugins.browsertab.openUrl(m),u.promise},register:async function(c){var u=k(),m=await e.createRegisterUrl(c);return universalLinks.subscribe("keycloak",function(b){universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();var v=z(b.url);M(v,u)}),window.cordova.plugins.browsertab.openUrl(m),u.promise},accountManagement:function(){var c=e.createAccountUrl();if(typeof c<"u")window.cordova.plugins.browsertab.openUrl(c);else throw"Not supported by the OIDC server"},redirectUri:function(c){return c&&c.redirectUri?c.redirectUri:e.redirectUri?e.redirectUri:"http://localhost"}};throw"invalid adapter type: "+o}const H="kc-callback-";var pe=function(){if(!(this instanceof pe))return new pe;localStorage.setItem("kc-test","test"),localStorage.removeItem("kc-test");var o=this;function a(){const h=Date.now();for(const[c,u]of d()){const m=f(u);(m===null||m<h)&&localStorage.removeItem(c)}}function p(){for(const[h]of d())localStorage.removeItem(h)}function d(){return Object.entries(localStorage).filter(([h])=>h.startsWith(H))}function f(h){let c;try{c=JSON.parse(h)}catch{return null}return be(c)&&"expires"in c&&typeof c.expires=="number"?c.expires:null}o.get=function(h){if(h){var c=H+h,u=localStorage.getItem(c);return u&&(localStorage.removeItem(c),u=JSON.parse(u)),a(),u}},o.add=function(h){a();const c=H+h.state,u=JSON.stringify({...h,expires:Date.now()+60*60*1e3});try{localStorage.setItem(c,u)}catch{p(),localStorage.setItem(c,u)}}},he=function(){if(!(this instanceof he))return new he;var o=this;o.get=function(f){if(f){var h=p(H+f);if(d(H+f,"",a(-100)),h)return JSON.parse(h)}},o.add=function(f){d(H+f.state,JSON.stringify(f),a(60))},o.removeItem=function(f){d(f,"",a(-100))};var a=function(f){var h=new Date;return h.setTime(h.getTime()+f*60*1e3),h},p=function(f){for(var h=f+"=",c=document.cookie.split(";"),u=0;u<c.length;u++){for(var m=c[u];m.charAt(0)==" ";)m=m.substring(1);if(m.indexOf(h)==0)return m.substring(h.length,m.length)}return""},d=function(f,h,c){var u=f+"="+h+"; expires="+c.toUTCString()+"; ";document.cookie=u}};function Et(){try{return new pe}catch{}return new he}function Je(o){return function(){e.enableLogging&&o.apply(console,Array.prototype.slice.call(arguments))}}}function Dt(t){const e=String.fromCodePoint(...t);return btoa(e)}async function Ht(t){const r=new TextEncoder().encode(t);if(typeof crypto>"u"||typeof crypto.subtle>"u")throw new Error("Web Crypto API is not available.");return await crypto.subtle.digest("SHA-256",r)}function ve(t){const[e,r]=t.split(".");if(typeof r!="string")throw new Error("Unable to decode token, payload not found.");let n;try{n=Kt(r)}catch(i){throw new Error("Unable to decode token, payload is not a valid Base64URL value.",{cause:i})}try{return JSON.parse(n)}catch(i){throw new Error("Unable to decode token, payload is not a valid JSON value.",{cause:i})}}function Kt(t){let e=t.replaceAll("-","+").replaceAll("_","/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("Input is not of the correct length.")}try{return Bt(e)}catch{return atob(e)}}function Bt(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,r)=>{let n=r.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function be(t){return typeof t=="object"&&t!==null}const Fe=t=>!!t.token;var lt=Symbol.for("immer-nothing"),Ge=Symbol.for("immer-draftable"),T=Symbol.for("immer-state");function C(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var K=Object.getPrototypeOf;function B(t){return!!t&&!!t[T]}function F(t){var e;return t?ft(t)||Array.isArray(t)||!!t[Ge]||!!((e=t.constructor)!=null&&e[Ge])||ie(t)||se(t):!1}var Jt=Object.prototype.constructor.toString();function ft(t){if(!t||typeof t!="object")return!1;const e=K(t);if(e===null)return!0;const r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Jt}function Z(t,e){oe(t)===0?Reflect.ownKeys(t).forEach(r=>{e(r,t[r],t)}):t.forEach((r,n)=>e(n,r,t))}function oe(t){const e=t[T];return e?e.type_:Array.isArray(t)?1:ie(t)?2:se(t)?3:0}function Ae(t,e){return oe(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function dt(t,e,r){const n=oe(t);n===2?t.set(e,r):n===3?t.add(r):t[e]=r}function Yt(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function ie(t){return t instanceof Map}function se(t){return t instanceof Set}function j(t){return t.copy_||t.base_}function Pe(t,e){if(ie(t))return new Map(t);if(se(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const r=ft(t);if(e===!0||e==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(t);delete n[T];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const l=i[s],y=n[l];y.writable===!1&&(y.writable=!0,y.configurable=!0),(y.get||y.set)&&(n[l]={configurable:!0,writable:!0,enumerable:y.enumerable,value:t[l]})}return Object.create(K(t),n)}else{const n=K(t);if(n!==null&&r)return{...t};const i=Object.create(n);return Object.assign(i,t)}}function Ne(t,e=!1){return ae(t)||B(t)||!F(t)||(oe(t)>1&&(t.set=t.add=t.clear=t.delete=$t),Object.freeze(t),e&&Object.entries(t).forEach(([r,n])=>Ne(n,!0))),t}function $t(){C(2)}function ae(t){return Object.isFrozen(t)}var qt={};function N(t){const e=qt[t];return e||C(0,t),e}var Y;function pt(){return Y}function Vt(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Qe(t,e){e&&(N("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function Ce(t){Ie(t),t.drafts_.forEach(Wt),t.drafts_=null}function Ie(t){t===Y&&(Y=t.parent_)}function Ze(t){return Y=Vt(Y,t)}function Wt(t){const e=t[T];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function et(t,e){e.unfinalizedDrafts_=e.drafts_.length;const r=e.drafts_[0];return t!==void 0&&t!==r?(r[T].modified_&&(Ce(e),C(4)),F(t)&&(t=ee(e,t),e.parent_||te(e,t)),e.patches_&&N("Patches").generateReplacementPatches_(r[T].base_,t,e.patches_,e.inversePatches_)):t=ee(e,r,[]),Ce(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==lt?t:void 0}function ee(t,e,r){if(ae(e))return e;const n=e[T];if(!n)return Z(e,(i,s)=>tt(t,n,e,i,s,r)),e;if(n.scope_!==t)return e;if(!n.modified_)return te(t,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let s=i,l=!1;n.type_===3&&(s=new Set(i),i.clear(),l=!0),Z(s,(y,g)=>tt(t,n,i,y,g,r,l)),te(t,i,!1),r&&t.patches_&&N("Patches").generatePatches_(n,r,t.patches_,t.inversePatches_)}return n.copy_}function tt(t,e,r,n,i,s,l){if(B(i)){const y=s&&e&&e.type_!==3&&!Ae(e.assigned_,n)?s.concat(n):void 0,g=ee(t,i,y);if(dt(r,n,g),B(g))t.canAutoFreeze_=!1;else return}else l&&r.add(i);if(F(i)&&!ae(i)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;ee(t,i),(!e||!e.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&te(t,i)}}function te(t,e,r=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&Ne(e,r)}function Xt(t,e){const r=Array.isArray(t),n={type_:r?1:0,scope_:e?e.scope_:pt(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=De;r&&(i=[n],s=$);const{revoke:l,proxy:y}=Proxy.revocable(i,s);return n.draft_=y,n.revoke_=l,y}var De={get(t,e){if(e===T)return t;const r=j(t);if(!Ae(r,e))return Gt(t,r,e);const n=r[e];return t.finalized_||!F(n)?n:n===ge(t.base_,e)?(we(t),t.copy_[e]=Le(n,t)):n},has(t,e){return e in j(t)},ownKeys(t){return Reflect.ownKeys(j(t))},set(t,e,r){const n=ht(j(t),e);if(n!=null&&n.set)return n.set.call(t.draft_,r),!0;if(!t.modified_){const i=ge(j(t),e),s=i==null?void 0:i[T];if(s&&s.base_===r)return t.copy_[e]=r,t.assigned_[e]=!1,!0;if(Yt(r,i)&&(r!==void 0||Ae(t.base_,e)))return!0;we(t),xe(t)}return t.copy_[e]===r&&(r!==void 0||e in t.copy_)||Number.isNaN(r)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=r,t.assigned_[e]=!0),!0},deleteProperty(t,e){return ge(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,we(t),xe(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const r=j(t),n=Reflect.getOwnPropertyDescriptor(r,e);return n&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:n.enumerable,value:r[e]}},defineProperty(){C(11)},getPrototypeOf(t){return K(t.base_)},setPrototypeOf(){C(12)}},$={};Z(De,(t,e)=>{$[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});$.deleteProperty=function(t,e){return $.set.call(this,t,e,void 0)};$.set=function(t,e,r){return De.set.call(this,t[0],e,r,t[0])};function ge(t,e){const r=t[T];return(r?j(r):t)[e]}function Gt(t,e,r){var i;const n=ht(e,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(t.draft_):void 0}function ht(t,e){if(!(e in t))return;let r=K(t);for(;r;){const n=Object.getOwnPropertyDescriptor(r,e);if(n)return n;r=K(r)}}function xe(t){t.modified_||(t.modified_=!0,t.parent_&&xe(t.parent_))}function we(t){t.copy_||(t.copy_=Pe(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Qt=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,r,n)=>{if(typeof e=="function"&&typeof r!="function"){const s=r;r=e;const l=this;return function(g=s,..._){return l.produce(g,I=>r.call(this,I,..._))}}typeof r!="function"&&C(6),n!==void 0&&typeof n!="function"&&C(7);let i;if(F(e)){const s=Ze(this),l=Le(e,void 0);let y=!0;try{i=r(l),y=!1}finally{y?Ce(s):Ie(s)}return Qe(s,n),et(i,s)}else if(!e||typeof e!="object"){if(i=r(e),i===void 0&&(i=e),i===lt&&(i=void 0),this.autoFreeze_&&Ne(i,!0),n){const s=[],l=[];N("Patches").generateReplacementPatches_(e,i,s,l),n(s,l)}return i}else C(1,e)},this.produceWithPatches=(e,r)=>{if(typeof e=="function")return(l,...y)=>this.produceWithPatches(l,g=>e(g,...y));let n,i;return[this.produce(e,r,(l,y)=>{n=l,i=y}),n,i]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){F(t)||C(8),B(t)&&(t=Zt(t));const e=Ze(this),r=Le(t,void 0);return r[T].isManual_=!0,Ie(e),r}finishDraft(t,e){const r=t&&t[T];(!r||!r.isManual_)&&C(9);const{scope_:n}=r;return Qe(n,e),et(void 0,n)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let r;for(r=e.length-1;r>=0;r--){const i=e[r];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}r>-1&&(e=e.slice(r+1));const n=N("Patches").applyPatches_;return B(t)?n(t,e):this.produce(t,i=>n(i,e))}};function Le(t,e){const r=ie(t)?N("MapSet").proxyMap_(t,e):se(t)?N("MapSet").proxySet_(t,e):Xt(t,e);return(e?e.scope_:pt()).drafts_.push(r),r}function Zt(t){return B(t)||C(10,t),yt(t)}function yt(t){if(!F(t)||ae(t))return t;const e=t[T];let r;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,r=Pe(t,e.scope_.immer_.useStrictShallowCopy_)}else r=Pe(t,!0);return Z(r,(n,i)=>{dt(r,n,yt(i))}),e&&(e.finalized_=!1),r}var U=new Qt,er=U.produce;U.produceWithPatches.bind(U);U.setAutoFreeze.bind(U);U.setUseStrictShallowCopy.bind(U);U.applyPatches.bind(U);U.createDraft.bind(U);U.finishDraft.bind(U);const tr={user:{id:"",email:"",firstName:"",lastName:"",username:"",roles:[]},posts:[]},Re=new Ft(tr),ce=Re;function q(t){function e(n){t(n)}const r=er(Re.getValue(),e);Re.next(r)}let rt,A;async function mt(){return await(await fetch("./html/config.json")).json()}async function rr(){rt=await mt(),A=new ut(rt);const t={onLoad:"check-sso",enableLogging:!0};try{let e=await A.init(t);e?(q(r=>r.token=A.token),console.log("token is",A.token),nr()):q(r=>delete r.token),console.log("authenticated:",e)}catch(e){console.error("Failed to initialize adapter:",e)}}async function nr(){const t=await A.loadUserProfile();q(e=>{e.token=A.token,e.user.firstName=t.firstName,e.user.lastName=t.lastName,e.user.email=t.email,e.user.id=t.id,e.user.token=A.token,e.user.roles=A.realmAccess.roles}),console.log("profile loaded")}async function or(){await A.login()}async function ir(){await A.logout(),A.clearToken(),q(t=>delete t.token)}function sr(){return A.token}function vt(){const t=sr(),e={Authorization:`Bearer ${t}`,Accept:"application/json"};return t||delete e.Authorization,e}const ar=(t,e)=>t.replace(/\$\{(\w+)\}/g,(r,n)=>e[n]),ue=async(t,e={})=>{const n=await(await fetch(`./html/${t}.html`)).text();return ar(n,e)},bt=(t,e)=>structuredClone(t)==structuredClone(e);async function gt(){const e=await fetch("./api/users/posts",{headers:vt()});if(e.ok){const r=await e.json();q(n=>n.posts=r)}else console.warn("failed to load hello",e)}const nt="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";class cr extends HTMLElement{async connectedCallback(){this.innerHTML=await ue("navigation-bar");const e=this.button("download-button");e.onclick=()=>window.open("/api/portation/xlsx");const r=this.button("upload-button");r.onclick=()=>this.dialog.showModal();const n=this.uploadInput;n.onchange=l=>this.uploadImportFile(l),n.accept=nt;const i=this.button("login-button"),s=[r,e];ce.pipe(je(l=>Fe(l)),ne()).subscribe(l=>{const{title:y,icon:g}=l?{title:"Logout",icon:"logout"}:{title:"Login",icon:"person"};i.title=y,i.innerText=g,i.onclick=l?ir:or,s.forEach(_=>_.hidden=!l)})}async uploadImportFile(e){const r=e.target;if(r.files.length>0){const i=r.files[0];if(confirm(`do your really want to import ${i.name} ?`)){const l=await fetch("/api/portation/xlsx",{method:"POST",headers:{...vt(),"content-type":nt},body:i});if(l.ok)alert("import done");else{const y=await l.json();console.error("upload failed",y);var n=JSON.stringify(y);alert(`Upload failed: ${l.statusText}: ${n}`)}gt(),this.dialog.close()}}}get dialog(){return this.querySelector("dialog")}get uploadInput(){return this.dialog.querySelector("input")}button(e){return this.querySelector(`[name='${e}']`)}}customElements.define("navigation-bar",cr);class ur extends HTMLElement{async connectedCallback(){this.innerHTML=await ue("content"),ce.pipe(je(lr),ne(bt)).subscribe(fr.bind(this))}}customElements.define("content-component",ur);function lr(t){return{user:t.user,roles:t.user.roles,posts:t.posts}}function fr(t){const e=this.querySelector("hgroup h2 span");e.innerText=`${t.user.firstName} ${t.user.lastName}`;const r=this.querySelector("hgroup p");r.innerText=t.user.email;const n=this.querySelector("tbody");n.innerHTML="",t.posts.forEach(s=>{var l=`<td>${s.title}</td><td>${s.body}</td><td>${s.published?"👍":"✋"}`,y=n.insertRow();y.innerHTML=l,y.onclick=()=>alert(`a Post has been selected. Title: "${s.title}"`)});const i=this.querySelector(".grid");i.innerHTML="",t.roles.forEach(s=>{var l=document.createElement("div");l.innerText=s,i.appendChild(l)})}class dr extends HTMLElement{async connectedCallback(){this.innerHTML=await ue("app-component");const e=this.querySelector("welcome-component"),r=this.querySelector("content-component");ce.pipe(je(n=>Fe(n)),ne()).subscribe(n=>{e.hidden=n,r.hidden=!n})}}customElements.define("app-component",dr);class pr extends HTMLElement{async connectedCallback(){const e=await mt();console.log("settings:",e),this.innerHTML=await ue("welcome",e)}}customElements.define("welcome-component",pr);async function hr(){rr(),ce.pipe(Xe(t=>Fe(t)),Xe(t=>t.posts.length==0),ne(bt)).subscribe(()=>{gt()})}hr();
